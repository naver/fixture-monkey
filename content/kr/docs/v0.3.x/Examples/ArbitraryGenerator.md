---
title: "ArbitraryGenerator"
linkTitle: "ArbitraryGenerator"
weight: 2
---
{{< alert color="secondary" title="Note">}}
기본적으로 제공하는 ArbitraryGenerator는 [여기]({{< relref "/docs/v0.3.x/features/arbitrarygenerator" >}})에서 확인할 수 있습니다.
{{< /alert >}}

## ArbitraryGenerator 추가하기
```java
@Test
void putArbitraryGenerator() {
    FixtureMonkey fixture = FixtureMonkey.builder()
        .putGenerator(CustomObject.class, FieldReflectionArbitraryGenerator.INSTANCE)
        .build();
	
    CustomObject customObject = this.fixture.giveMeOne(CustomObject.class);
    // generated by FieldReflectionArbitraryGenerator
}
```

## 기본 ArbitraryGenerator 설정하기
```java
@Test
void putArbitraryGenerator() {
    FixtureMonkey fixture = FixtureMonkey.builder()
        .defaultGenerator(FieldReflectionArbitraryGenerator.INSTANCE)
        .build();
	
    CustomObject customObject = this.fixture.giveMeOne(CustomObject.class);
    // generated by FieldReflectionArbitraryGenerator
}
```

## ArbitraryBuilder에서 사용할 ArbitraryGenerator 설정하기
```java
@Test
void setArbitraryGenerator() {
    FixtureMonkey fixture = FixtureMonkey.builder().build();
	
    Person personByBuilder = this.fixture.giveMeBuilder(Person.class)
	    .generator(ConstructorPropertiesArbitraryGenerator.INSTANCE)
	    .sample(); 
    // generated by ConstructorPropertiesArbitraryGenerator
}
```

## 나만의 ArbitraryGenerator 정의하기
```java
public class CustomArbitraryGenerator implements ArbitraryGenerator {
		public CustomArbitraryGenerator() {
		}

		@Override
		public <T> Arbitrary<T> generate(ArbitraryType type, List<ArbitraryNode> nodes) {
			// using type and ArbitraryNodes to generate Arbitrary<T>
			return ...;
		}
	}
}
```

### WithCustomizer
```java
public class CustomArbitraryGenerator implements ArbitraryGenerator, WithFixtureCustomizer {
		private final ArbitraryCustomizers arbitraryCustomizers;

		public CustomArbitraryGenerator() {
			this(new ArbitraryCustomizers());
		}

		public CustomArbitraryGenerator(ArbitraryCustomizers arbitraryCustomizers) {
			this.arbitraryCustomizers = arbitraryCustomizers;
		}

		@Override
		public ArbitraryGenerator withFixtureCustomizers(ArbitraryCustomizers arbitraryCustomizers) {
			if (this.arbitraryCustomizers == arbitraryCustomizers) {
				return this;
			}

			return new CustomArbitraryGenerator(this.arbitraryCustomizers);
		}

		@Override
		public <T> Arbitrary<T> generate(ArbitraryType type, List<ArbitraryNode> nodes) {
			// using type and ArbitraryNodes to generate Arbitrary<T>
			return ...;
		}
	}
}
```

## 복잡한 ArbitraryGenerator 기능들
### JacksonArbitraryGenerator에서 @JsonProperty로 선언한 필드 사용 예시
```java
@Value
class Person {
    @JsonPropert("id")
    String personId;
}
@Test
void setFieldInJacksonArbitraryGeneratorWithJsonProperty() {
	// given
    FixtureMonkey fixture = FixtureMonkey.builder()
        .defaultGenerator(JacksonArbitraryGenerator.INSTANCE)
        .build();
    // when
    Person actual = this.fixture.giveMeBuilder(Person.class)
        .set("id", "12345")
        .sample();
    
    then(actual.personId).isEqualTo("12345");
}
```

### @ConstructorProperties로 설정한 이름과 실제 필드명이 다른 경우 사용 예시
```java
class Person {
    String id;
    String name;
    
    @ConstructorProperties({"id", "personName"})
    public Person(String id, String personName){
    	this.id = id;
    	this.name = personName;
    }
}
@Test
void addConstructorPropertiesValueWhenFieldNameIsDifferent() {
	// given
    FixtureMonkey fixture = FixtureMonkey.builder()
        .defaultGenerator(ConstructorPropertiesGenerator.INSTANCE)
        .build();
    // when
	Person actual = fixtureMonkey.giveMeOne(Person.class, new ArbitraryCustomizer<>() {
		@Override
		public void customizeFields(Class<Person> type, FieldArbitraries fieldArbitraries) {
			fieldArbitraries.putArbitrary("personName", Arbitraries.of("BROWN"));
		}
		@Override
		public Person customizeFixture(Person object) {
			return object;
		}
	});
	then(actual.id).isNotNull();
	then(actual.name).isEqualTo("BROWN");
}
```

### 실제 필드로 존재하지 않지만 @ConstructorProperties에서 선언한 값 제어하는 예시 
```java
class Person {
    String id;
    
    @ConstructorProperties({"id", "idSuffix"})
    public Person(String id, String idSuffix){
    	this.id = id + idSuffix;
    }
}
@Test
void addConstructorPropertiesValueWithoutCorrespondingField() {
	// given
    FixtureMonkey fixture = FixtureMonkey.builder()
        .defaultGenerator(ConstructorPropertiesGenerator.INSTANCE)
        .build();
    // when
	Person actual = fixtureMonkey.giveMeOne(Person.class, new ArbitraryCustomizer<>() {
		@Override
		public void customizeFields(Class<Person> type, FieldArbitraries fieldArbitraries) {
			fieldArbitraries.putArbitrary("idSuffix", Arbitraries.of("SALLY"));
		}
		@Override
		public Person customizeFixture(Person object) {
			return object;
		}
	});
	then(actual.id).contains("SALLY");
}
```
